# Pluralization

Pluralization is a process of handling the plural form of a word. It's also known as `plural handling` or `plural form` in other localization system. It's also a powerful feature that makes any internationalization system complete!  

Let's say, you have a message that says "You have ``{count}`` apple". It's correct if you have only one apple. But if you have more than one apple, it should be "You have ``{count}`` apple**_s_**", right? That's where pluralization comes in handy!

---

## Static Pluralization

GM-I18n provides a simple pluralization feature that can handle the plural form of a word/phrase in the message. 

> Format: `form0 | form1 | ...` <br>
> Access: `<index>` or `{plural: <index>}` <br>
> Usage: `i18n_get_messages()`, `i18n_create_ref_message()`, `i18n_draw_message()`

For the static pluralization, the simplest way, you need to provide 2 forms of the word/phrase in the message. Generally, the first form is for singular, and the second form is for plural. And then you can pass the index of the form you want to use in the data.

::code-group
```js [Create Event]
// assume the system is initialized on global variable
// i18n_get_messages(key, [data], [locale], [i18n])
// i18n_create_ref_message(var_name, key, [data], [i18n])

// static messages, static pluralization
msg1 = i18n_get_messages("have_apple");             // "You don't have any apple | You have apple(s)", raw message

msg2 = [                                            // in an array
    i18n_get_messages("have_apple", 0)              // "You don't have any apple", 0 = directly use the first form
];  

msg3 = {                                                        // in a struct
    my_msg : i18n_get_messages("have_apple", 1, "id");          // "Kamu punya apel", 1 = directly use the second form
}; 

msg4 = i18n_get_messages("have_apple_cnt", {plural: 1});        // "I have 1 apple", {plural: 1} = use the second form through the `plural` key
msg5 = i18n_get_messages("have_apple_cnt", {                    // "I have 10 apples", {plural: 2} = use the third form, {count: 10} = replace the {count} placeholder
    plural : 2,                                                 // need to set the index value of the `plural` key manually
    count : 10                                                  // interpolate the {count} placeholder
});

// dynamic messages, static pluralization, no difference with static messages 
global.ref_msg1 = i18n_create_ref_message("global.ref_msg1", "have_apple");

global.ref_msg2 = [
    i18n_create_ref_message("g.ref_msg2.0", "have_apple", 0)
];

ref_msg3 = {
    my_msg : i18n_create_ref_message("ref_msg3.my_msg", "have_apple", 1, "id")
}

global.ref_msg4 = i18n_create_ref_message("global.ref_msg4", "have_apple_cnt", {plural: 1});
ref_msg5 = i18n_create_ref_message("ref_msg5", "have_apple_cnt", {
    plural: 2, 
    count: 10
});
```

```json [en.json]
{
    "have_apple": "You don't have any apple | You have apple(s)",
    "have_apple_cnt": "I don't have any apple | I have 1 apple | I have {count} apples"
}
```

```json [id.json]
{
    "have_apple": "Kamu tidak punya apel | Kamu punya apel",
    "have_apple_cnt": "Aku tidak punya apel | Aku punya 1 apel | Aku punya {count} apel"
}
```
::

::alert{type="info"}
You can use the `<index>` or `{plural: <index>}` to access the plural form. Both are valid. But it's recommended to use the `{plural: <index>}` because it's more readable and flexible. You can see the example in the next section. <br> <br>
::

::alert{type="warning"}
The plural form is **static**. So, if you change the value of the `plural` key after creating the message, it won't affect the plural form in the message. <br> <br>

You **can't** use the pluralization feature with the **indexed data**. You need to use the **named data** instead. See the [Interpolation](/v0/usage/interpolation) section for more information.
::

---

## Dynamic Pluralization

Dynamic pluralization use the same format as static pluralization, but the forms are **dynamic**. So, you can change the plural form in the message, even after creating the message.

> Format: `form0 | form1 | ...` <br>
> Access: `<index>` or `{plural: <index>}` or `{plural: <function>, plural_value: <value>}` <br>
> Usage: `i18n_get_messages()`, `i18n_create_ref_message()`, `i18n_draw_message()`

You can make your own pluralization rule in the `plural` key in the named data. The function will be called with the `plural_value` as the parameter, and then it will return the `index` of the plural form you want to use. It's great for complex pluralization rule!

::code-group
```js [Create]
// assume the system is initialized on global variable

// the value to be passed to the pluralization function
apple_count = 0;

// static messages, dynamic pluralization
msg1 = i18n_get_messages("have_apple_cnt", 0, "en");        // "I don't have any apple", will updated in Step Event

// dynamic messages, dynamic pluralization
global.ref_msg1 = i18n_create_ref_message("global.ref_msg1", "have_apple_cnt", {
    plural: function(plural_value) {                                            // the function for complex pluralization rule
        if (i18n_get_locale() == "en") {                                        // en locale has 3 forms
            return !plural_value ? 0 : (plural_value == 1 ? 1 : 2);             // if plural_value is 0, use the first form (index 0). if plural_value is 1, use the second form (index 1). otherwise, use the third form (index 2)
        } else if (i18n_get_locale() == "id") {                                 // id locale has only 2 forms
            return !plural_value ? 0 : 1;                                       // if plural_value is 0, use the first form (index 0). otherwise, use the second form (index 1)
        }
    },
    plural_value: apple_count,                                                  // the value to be passed to the pluralization function
    count: apple_count                                                          // interpolate the {count} placeholder
});
```

```js [Step]
// if you've created static message, you need to update the message every step
// so, the pluralization will be updated automatically
msg1 = i18n_get_messages("have_apple_cnt",                  // simple pluralization rule
    (!apple_count ? 0 : (apple_count == 1 ? 1 : 2)),        // if apple_count is 0, use the first form (index 0). if apple_count is 1, use the second form (index 1). otherwise, use the third form (index 2)
"en");                                                      // only applicable for static messages
```

```js [Draw]
// or you can draw the message directly
i18n_draw_message(100, 50, "@:have_apple_cnt",              // static message, dynamic pluralization
    (!apple_count ? 0 : 1),                                 // if apple_count is 0, use the first form (index 0). otherwise, use the second form (index 1)
"id");                                                      // see the message difference between en and id locale
```

```js [Key Pressed - Up]
// increase the apple count
apple_count++;
```

```js [Key Pressed - Down]
// decrease the apple count
apple_count--;
```

```js [Key Pressed - Space]
// update the plural value in the message reference
i18n_update_plurals("global.ref_msg1", apple_count, true);
```

```json [en.json]
{
    "have_apple_cnt": "I don't have any apple | I have 1 apple | I have {count} apples"
}
```

```json [id.json]
{
    "have_apple_cnt": "Aku tidak punya apel | Aku punya {count} apel"
}
```
::

